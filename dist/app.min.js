/*! qd-backend - v0.1.0 - 2014-09-22 12:54:22
* Copyright (c) 2014 lovemoon@yeah.net; Licensed GPLv2 */
!function(){var a=angular.module("app",["ui.router","templates","homeModule"]);angular.element(document).ready(function(){angular.bootstrap(document,["app"])});var b=function(a){var c,d,e,f,g,h,i,j="";for(c in a)if(a.hasOwnProperty(c))if(d=a[c],d instanceof Array)for(i=0;i<d.length;++i)g=d[i],e=c+"["+i+"]",h={},h[e]=g,j+=b(h)+"&";else if(d instanceof Object)for(f in d)d.hasOwnProperty(f)&&(g=d[f],e=c+"["+f+"]",h={},h[e]=g,j+=b(h)+"&");else void 0!==d&&null!==d&&(j+=encodeURIComponent(c)+"="+encodeURIComponent(d)+"&");return j.length?j.substr(0,j.length-1):j};a.config(["$httpProvider",function(a){a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",a.defaults.transformRequest=[function(a){return angular.isObject(a)&&"[object File]"!==String(a)?b(a):a}],a.interceptors.push(["$q","$injector",function(a,b){return{request:function(b){var c=b.url.match(/:(\w+)/g);return null!==c&&angular.forEach(c,function(a){var c=a.substring(1);b.params&&b.params.hasOwnProperty(c)?(b.url=b.url.replace(a,b.params[c]),delete b.params[c]):b.data&&b.data.hasOwnProperty(c)&&(b.url=b.url.replace(a,b.data[c]),delete b.data[c])}),a.when(b)},response:function(c){if(angular.isObject(c.data)){var d=c.data;return d.data=d.data||{},(d.data.message||d.message)&&(d.data.message=d.data.message||d.message),-1===[0,200].indexOf(d.code)&&b.get("$cacheFactory").get("$http").removeAll(),c.config.$parsing!==!1?-1!==[0,200].indexOf(d.code)?d.data:(c.config.$silence!==!0&&alert(d.data.message||"不好意思，服务器开小差了。"),a.reject(d.data)):a.when(c.data)}return a.when(c)},requestError:function(b){return a.reject(b)},responseError:function(b){return a.reject(b)}}}])}]),a.run(["$rootScope",function(a){a.title="千丁小区";var b={"IT民工薪资测试":["home"],"选择职业":["skill"],"技能测试":["examine"],"测试结果":["salary"]};a.$on("$stateChangeSuccess",function(c,d){for(var e in b)b.hasOwnProperty(e)&&-1!==b[e].indexOf(d.name)&&(a.title=e)})}]),a.config(["$locationProvider",function(){}]),a.run(["$rootScope",function(a){var b=function(){WeixinJSBridge.call("hideToolbar")};a.$on("$stateChangeStart",function(){"undefined"==typeof WeixinJSBridge?document.addEventListener("WeixinJSBridgeReady",b,!1):b()})}]),a.directive("csLayout",["$rootScope",function(a){return{restrict:"A",templateUrl:"common/templates/layout.partial.html",link:function(b,c){a.$on("$stateChangeSuccess",function(a,b){c.attr("class",b.name.replace(/\./g,"-"))})}}}]),a.filter("group",function(){return function(a,b){if(!a)return a;if(a.$rows){for(var c=[],d=0;d<a.$rows.length;d++)c=c.concat(a.$rows[d]);if(c.length!==a.length)delete a.$rows;else for(var e=0;e<a.length;e++)if(a[e]!==c[e]){delete a.$rows;break}}if(!a.$rows){for(var f=[],g=0;g<a.length;g++)g%b===0&&f.push([]),f[f.length-1].push(a[g]);a.$rows=f}return a.$rows}}),a.filter("empty",function(){return function(a){return!a||angular.equals({},a)||angular.equals([],a)}}),a.filter("min",function(){return function(a,b){return Math.min(a,b)}}),a.filter("max",function(){return function(a,b){return Math.max(a,b)}}),a.filter("safe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),a.filter("is",function(){return function(a,b){return b=angular.isUndefined(b)?!0:b,a=b?a:!a,a?"是":"否"}});var c=angular.module("homeModule",["ui.router"]);c.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:"modules/home/templates/home.html"}).state("skill",{url:"/skill",templateUrl:"modules/home/templates/skill.html",controller:"skillController"}).state("examine",{url:"/examine/:skill",templateUrl:"modules/home/templates/examine.html",controller:"examineController"}).state("salary",{url:"/salary/:salary",templateUrl:"modules/home/templates/salary.html",controller:"salaryController"})}]),c.controller("skillController",["$scope","homeService",function(a,b){b.listSkill().then(function(b){a.list=b.list})}]),c.controller("examineController",["$scope","$state","$stateParams","$timeout","homeService",function(a,b,c,d,e){var f=null,g=[],h=function(){g.length===f.length&&b.go("salary",{salary:i()}),a.question=f[g.length]},i=function(){return 311320};a.choose=function(a){g.push(a),a.$active=!0,d(h,200)},e.getQuestions(c.skill).then(function(a){f=a.list,h()})}]),c.controller("salaryController",["$scope","$state","$stateParams",function(a,b,c){a.salary=c.salary}]),c.filter("salary",function(){return function(a){return/^\d+$/.test(a)?(parseFloat(a)/1e4).toFixed(0)+"万":a}}),c.factory("homeService",["$http",function(a){return{listSkill:function(){return a({url:"/service/skill",method:"get",cache:!0})},getQuestions:function(b){return a({url:"/service/questions",method:"get",params:{skill:b},cache:!0})}}}]),angular.module("templates",["common/templates/layout.partial.html","modules/home/templates/examine.html","modules/home/templates/home.html","modules/home/templates/salary.html","modules/home/templates/skill.html"]),angular.module("common/templates/layout.partial.html",[]).run(["$templateCache",function(a){a.put("common/templates/layout.partial.html",'<div class="ui-view"></div>')}]),angular.module("modules/home/templates/examine.html",[]).run(["$templateCache",function(a){a.put("modules/home/templates/examine.html",'<h1 class="text-center">{{ question.title }}</h1><h4 class="center-block">{{ question.subtitle }}</h4><div class="questions"><table class="table"><tbody><tr ng-repeat="item in question.options" ng-class="{active: item.$active}" ng-click="choose(item)"><td class="radio"><i></i></td><td class="option">{{ item.desc }}</td></tr></tbody></table></div>')}]),angular.module("modules/home/templates/home.html",[]).run(["$templateCache",function(a){a.put("modules/home/templates/home.html",'<div class="sprite sprite-logo center-block"></div><a class="sprite sprite-start center-block" ui-sref="skill"></a>')}]),angular.module("modules/home/templates/salary.html",[]).run(["$templateCache",function(a){a.put("modules/home/templates/salary.html",'<div class="sprite sprite-over center-block"></div><h3 class="text-center">恭喜你，你的年薪是</h3><h1 class="text-center">{{ salary | salary }}</h1><div class="conclusion"><hr><p>当然这些都只是预估啦，薪水神马的不仅仅跟技术水平相关，还跟地域、行业、公司都有关系。</p><p>可是想要在技术领域里做出一点成绩来，还是需要多了解一些大牛们的技术体系，<a>点击这里</a>去看下高薪职位对应<a>技能树</a>吧~</p><p>或者先分享给朋友们，嘚瑟一下~</p><a class="btn btn-primary btn-block">绝不能一个人享，分享给朋友</a></div>')}]),angular.module("modules/home/templates/skill.html",[]).run(["$templateCache",function(a){a.put("modules/home/templates/skill.html",'<ul class="list-unstyled skill-list center-block"><li ng-repeat="name in list"><a ui-sref="examine({skill: name})"><span>{{ name }}</span>程序员</a></li></ul>')}])}();